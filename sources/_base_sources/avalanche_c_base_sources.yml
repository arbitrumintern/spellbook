version: 2

sources:
  # Base Tables
  - name: avalanche_c
    description: "Avalanche C raw tables including transactions, traces and logs."
    freshness:
      warn_after: { count: 12, period: hour }
    tables:
      - name: transactions
        meta:
          docs_slug: /evm/avalanchec/raw/transactions
          short_description: The `avalanche_c.transactions` table contains detailed information about transactions on the Avalanche C blockchain, including block data, transaction values, and gas-related metrics. 
        loaded_at_field: block_time
        description: '{{ doc("avalanche_c_transactions_doc") }}'
        
        columns:
          - &block_date
            name: block_date
            description: "The UTC date of the block in which this transaction was included"
          - &block_time
            name: block_time
            description: "The exact UTC timestamp when the block containing this transaction was mined"
          - &value
            name: value
            description: "Amount of AVAX sent from sender to recipient, measured in wei (1 AVAX = 10^18 wei)"
          - &block_number
            name: block_number
            description: "The sequential number of the block containing this transaction on the Avalanche C blockchain"
          - name: gas_limit
            description: "Maximum number of gas units the transaction initiator is willing to consume for this transaction"
          - name: gas_price
            description: "Price per unit of gas for this transaction, denominated in wei (1 gwei = 10^9 wei)"
          - name: gas_used
            description: "Actual amount of gas units consumed by this transaction's execution"
          - name: max_fee_per_gas
            description: "Maximum total amount per gas unit the initiator is willing to pay, including base fee and priority fee"
          - name: max_priority_fee_per_gas
            description: "Maximum additional fee per gas unit the initiator is willing to pay as a tip to validators"
          - name: base_fee_per_gas
            description: "Minimum fee per gas unit required for transaction inclusion, burned by the protocol"
          - name: nonce
            description: "Sequential number representing the count of transactions sent from the sender's address"
          - name: index
            description: "Position of this transaction within its containing block"
          - &success
            name: success
            description: "Boolean flag indicating whether the transaction executed successfully (true) or failed (false)"
          - &from
            name: from
            description: "Avalanche C address of the account that initiated and signed this transaction"
          - &to
            name: to
            description: "Avalanche C address of the recipient account or contract for this transaction"
          - &block_hash
            name: block_hash
            description: "Unique 256-bit identifier (hash) of the block containing this transaction"
          - name: data
            description: "Input data of the transaction, which may include function calls or contract interaction data"
          - name: hash
            description: "Unique 256-bit identifier (hash) of this specific transaction"
          - name: type
            description: "Type of transaction (e.g., legacy, EIP-1559) indicating its structure and fee mechanism"
          - name: access_list
            description: "List of addresses and storage keys the transaction plans to access, used for gas optimization in EIP-2930 transactions"
          - name: effective_gas_price
            description: "Actual price per gas unit paid for this transaction, calculated post-execution"

      - name: traces
        meta:
          docs_slug: /evm/avalanchec/raw/traces
          short_description: The `avalanche_c.traces` table contains information about traces on the Avalanche C blockchain.
        loaded_at_field: block_time
        description: '{{ doc("avalanche_c_traces_doc") }}'
        columns:
          - *block_date
          - *block_time
          - *block_number
          - *value
          - name: gas
            description: "Amount of gas allocated for this trace's execution"
          - name: gas_used
            description: "Actual amount of gas consumed by this trace's execution"
          - *block_hash
          - name: success
            description: "Boolean flag indicating whether this specific trace was executed successfully"
          - &tx_index
            name: tx_index
            description: "Position of the parent transaction within its containing block"
          - name: subtraces
            description: "Number of child traces spawned by this trace during execution"
          - name: error
            description: "Error message or code if the trace execution failed"
          - name: tx_success
            description: "Boolean flag indicating whether the parent transaction of this trace was successful"
          - &tx_hash
            name: tx_hash
            description: "Unique 256-bit identifier (hash) of the parent transaction"
          - name: from
            description: "Avalanche C address that initiated this trace"
          - name: to
            description: "Avalanche C address that received this trace"
          - name: trace_address
            description: "Array indicating the exact position of this trace within the trace tree of the transaction"
          - name: type
            description: "Type of trace (e.g., call, create, suicide) indicating the nature of the operation"
          - name: address
            description: "Avalanche C address of the account or contract that created this trace"
          - name: code
            description: "Raw EVM bytecode executed in this trace, if applicable"
          - name: call_type
            description: "Type of call made in this trace (e.g., call, delegatecall, staticcall)"
          - name: input
            description: "Input data provided to this trace, often containing function signatures and parameters"
          - name: output
            description: "Data returned by this trace after execution"
          - name: refund_address
            description: "Avalanche C address designated to receive any gas refund from this trace"

      - name: traces_decoded
        meta:
          docs_slug: /evm/avalanchec/decoded/traces_decoded
          short_description: The `avalanche_c.traces_decoded` table contains decoded Avalanche C traces, including additional information based on submitted smart contracts and their ABIs.
        loaded_at_field: block_time
        description: '{{ doc("avalanche_c_traces_decoded_doc") }}'
        columns:
          - *block_date
          - *block_time
          - *block_number
          - name: contract_name
            description: "Human-readable name of the smart contract involved in this trace"
          - name: function_name
            description: "Name of the specific contract function called in this trace"
          - name: namespace
            description: "Categorical grouping or project name associated with the contract"
          - name: signature
            description: "Function signature including name and parameter types"
          - name: to
            description: "Avalanche C address of the contract or account receiving this trace"
          - name: trace_address
            description: "Array indicating the exact position of this trace within the trace tree of the transaction"
          - *tx_hash

      - name: logs
        meta:
          docs_slug: /evm/avalanchec/raw/logs
          short_description: The `avalanche_c.logs` table contains information about event logs emitted by smart contracts on the Avalanche C blockchain.
        loaded_at_field: block_time
        description: '{{ doc("avalanche_c_logs_doc") }}'
        columns:
          - *block_date
          - *block_time
          - *block_number
          - *block_hash
          - name: contract_address
            description: "Avalanche C address of the smart contract that emitted this log"
          - name: topic1
            description: "First 32-byte topic, typically containing the event signature hash"
          - name: topic2
            description: "Second 32-byte topic, often containing indexed event parameters"
          - name: topic3
            description: "Third 32-byte topic, often containing indexed event parameters"
          - name: topic4
            description: "Fourth 32-byte topic, often containing indexed event parameters"
          - name: data
            description: "ABI-encoded data of the log, containing non-indexed event parameters"
          - *tx_hash
          - name: index
            description: "Position of this log within the block"
          - *tx_index

      - name: logs_decoded
        meta:
          docs_slug: /evm/avalanchec/decoded/logs_decoded
          short_description: The `avalanche_c.logs_decoded` table contains decoded Avalanche C logs, including additional information based on submitted smart contracts and their ABIs.
        loaded_at_field: block_time
        description: '{{ doc("avalanche_c_logs_decoded_doc") }}'
        columns:
          - *block_date
          - *block_time
          - *block_number
          - name: index
            description: "Position of this log within the block"
          - name: contract_address
            description: "Avalanche C address of the smart contract that emitted this log"
          - name: contract_name
            description: "Human-readable name of the smart contract that emitted this log"
          - name: event_name
            description: "Name of the specific event emitted in this log"
          - name: namespace
            description: "Categorical grouping or project name associated with the contract"
          - name: signature
            description: "Event signature including name and parameter types"
          - *tx_hash

      - name: blocks
        meta:
          docs_slug: /evm/avalanchec/raw/blocks
          short_description: The `avalanche_c.blocks` table contains information about Avalanche C blocks. Each row represents a single block.
        freshness:
          warn_after: { count: 1, period: day }
        loaded_at_field: time
        description: '{{ doc("avalanche_c_blocks_doc") }}'
        columns:
          - name: base_fee_per_gas
            description: "Minimum fee per gas unit required for transaction inclusion in this block"
          - name: difficulty
            description: "Measure of how difficult it was to mine this block (may be deprecated in Avalanche C)"
          - name: gas_limit
            description: "Maximum amount of gas that can be used by all transactions in this block"
          - name: gas_used
            description: "Total amount of gas actually consumed by all transactions in this block"
          - name: hash
            description: "Unique 256-bit identifier (hash) of this block"
          - name: miner
            description: "Avalanche C address of the validator who proposed this block"
          - name: nonce
            description: "Block's nonce value, used in the consensus mechanism"
          - name: number
            description: "Sequential number of this block in the Avalanche C blockchain"
          - name: parent_hash
            description: "Hash of the parent (previous) block in the chain"
          - name: size
            description: "Size of this block in bytes"
          - name: time
            description: "Timestamp when this block was mined"
          - name: total_difficulty
            description: "Total chain difficulty up to this block (may be deprecated in Avalanche C)"

      - name: contracts
        meta:
          docs_slug: /evm/avalanchec/raw/contracts
          short_description: The `avalanche_c.contracts` table is a view tracking decoded contracts on Avalanche C, including associated metadata such as namespace, name, address, ABI.
        freshness:
          warn_after: { count: 1, period: day }
          error_after: { count: 3, period: day }
        loaded_at_field: created_at
        description: '{{ doc("avalanche_c_contracts_doc") }}'
        columns:
          - name: abi
            description: "JSON representation of the contract's Application Binary Interface (ABI)"
          - name: address
            description: "Avalanche C address of the deployed contract"
          - name: from
            description: "Avalanche C address that deployed this contract"
          - name: code
            description: "Bytecode of the contract at the time of creation"
          - name: name
            description: "Human-readable name assigned to the contract"
          - name: namespace
            description: "Categorical grouping or project name associated with the contract"
          - name: dynamic
            description: "Boolean indicating if the contract's ABI can change dynamically"
          - name: base
            description: "Boolean indicating if this is a base contract (not derived from other contracts)"
          - name: factory
            description: "Boolean indicating if this contract can deploy other contracts"
          - name: detection_source
            description: "Method used to detect and decode this contract: 'factory', 'base', or 'dynamic'"
          - name: created_at
            description: "Timestamp of when this contract was created or first detected"
          
      - name: creation_traces
        meta:
          docs_slug: /evm/avalanchec/raw/creation_traces
          short_description: The `avalanche_c.creation_traces` table contains information about contract creation traces on the Avalanche C blockchain. It includes details about newly created contracts, their creators, and the contract code.
        loaded_at_field: block_time
        description: '{{ doc("avalanche_c_creation_traces_doc") }}'
        columns:
          - *block_time
          - *block_number
          - *tx_hash
          - name: address
            description: "Contract address created"
          - name: from
            description: "Contract creator address"
          - name: code
            description: "Contract code"

  # ERC Transfer Tables
  - name: erc20_avalanche_c
    description: "Transfer events for ERC20 tokens on Avalanche C"
    tables:
      - name: evt_transfer
        meta:
          docs_slug: /evm/avalanchec/decoded/evt_transfer
          short_description: The `avalanche_c.evt_transfer` table contains individual transfer events for ERC20 tokens on the Avalanche C blockchain. Each row represents a single token transfer.
        loaded_at_field: evt_block_time
        description: '{{ doc("erc20_avalanche_c_evt_transfer_doc") }}'
        freshness:
          warn_after: { count: 12, period: hour }
          error_after: { count: 24, period: hour }
        columns:
          - name: contract_address
            description: "Avalanche C address of the ERC20 token contract"
          - &evt_tx_hash
            name: evt_tx_hash
            description: "Hash of the transaction containing this transfer event"
          - &evt_index
            name: evt_index
            description: "Index position of this event within the transaction"
          - &evt_block_time
            name: evt_block_time
            description: "Timestamp of the block containing this transfer event"
          - &evt_block_number
            name: evt_block_number
            description: "Block number containing this transfer event"
          - *from
          - *to
          - name: value
            description: "Amount of ERC20 tokens transferred, in the token's smallest unit"

      - name: evt_approval
        meta:
          docs_slug: /evm/avalanchec/decoded/evt_approval
          short_description: The `avalanche_c.evt_approval` table contains approval events for ERC20 tokens on Avalanche C, allowing an address to spend tokens on behalf of the owner.
        loaded_at_field: evt_block_time
        description: '{{ doc("erc20_avalanche_c_evt_approval_doc") }}'
        columns:
          - name: contract_address
            description: "Avalanche C address of the ERC20 token contract"
          - *evt_tx_hash
          - *evt_index
          - *evt_block_time
          - *evt_block_number
          - name: owner
            description: "Avalanche C address of the token owner granting approval"
          - name: spender
            description: "Avalanche C address being granted permission to spend tokens"
          - name: value
            description: "Amount of ERC20 tokens approved for spending, in the token's smallest unit"

  - name: erc1155_avalanche_c
    description: "Transfer events for ERC1155 tokens on Avalanche C"
    tables:
    - name: evt_transfersingle
      meta:
        docs_slug: /evm/avalanchec/decoded/evt_transfersingle
        short_description: The `avalanche_c.evt_transfersingle` table contains single transfer events for ERC1155 tokens on the Avalanche C blockchain.
      loaded_at_field: evt_block_time
      description: '{{ doc("erc1155_avalanche_c_evt_transfersingle_doc") }}'
      columns:
        - name: contract_address
          description: "Avalanche C address of the ERC1155 token contract"
        - *evt_tx_hash
        - *evt_index
        - *evt_block_time
        - *evt_block_number
        - name: operator
          description: "Avalanche C address authorized to execute the transfer on behalf of the owner"
        - *from
        - *to
        - name: id
          description: "Unique identifier of the ERC1155 token being transferred"
        - name: value
          description: "Quantity of the ERC1155 token transferred"
    - name: evt_transferbatch
      meta:
        docs_slug: /evm/avalanchec/decoded/evt_transferbatch
        short_description: The `avalanche_c.evt_transferbatch` table contains batch transfer events for multiple ERC1155 tokens on the Avalanche C blockchain.
      loaded_at_field: evt_block_time
      description: '{{ doc("erc1155_avalanche_c_evt_transferbatch_doc") }}'
      columns:
        - name: contract_address
          description: "Avalanche C address of the ERC1155 token contract"
        - *evt_tx_hash
        - *evt_index
        - *evt_block_time
        - *evt_block_number
        - name: operator
          description: "Avalanche C address authorized to execute the batch transfer on behalf of the owner"
        - *from
        - *to
        - name: ids
          description: "Array of unique identifiers of the ERC1155 tokens being transferred"
        - name: values
          description: "Array of quantities for each ERC1155 token transferred, corresponding to the ids array"
    - name: evt_ApprovalForAll
      meta:
        docs_slug: /evm/avalanchec/decoded/evt_ApprovalForAll
        short_description: The `avalanche_c.evt_ApprovalForAll` table contains approval events for all tokens of an ERC1155 contract on the Avalanche C blockchain.
      loaded_at_field: evt_block_time
      description: '{{ doc("erc1155_avalanche_c_evt_ApprovalForAll_doc") }}'
      columns:
        - name: contract_address
          description: "Avalanche C address of the ERC1155 token contract"
        - *evt_tx_hash
        - *evt_index
        - *evt_block_time
        - *evt_block_number
        - &approved
          name: approved
          description: "Boolean indicating whether approval is granted (true) or revoked (false)"
        - &owner
          name: owner
          description: "Avalanche C address of the token owner granting or revoking approval"
        - name: operator
          description: "Avalanche C address being granted or revoked permission to operate all tokens"
          
  - name: erc721_avalanche_c
    description: '{{ doc("erc721_avalanche_c_evt_transfer_doc") }}'
    tables:
    - name: evt_transfer
      loaded_at_field: evt_block_time
      description: "Transfer events for ERC721 tokens (NFTs) on Avalanche C"
      columns:
        - name: contract_address
          description: "Avalanche C address of the ERC721 token contract"
        - *evt_tx_hash
        - *evt_index
        - *evt_block_time
        - *evt_block_number
        - *from
        - *to
        - name: tokenId
          description: "Unique identifier of the ERC721 token (NFT) being transferred"
    - name: evt_Approval
      meta:
        docs_slug: /evm/avalanchec/decoded/evt_Approval
        short_description: The `avalanche_c.evt_Approval` table contains approval events for individual ERC721 tokens (NFTs) on the Avalanche C blockchain.
      loaded_at_field: evt_block_time
      description: '{{ doc("erc721_avalanche_c_evt_Approval_doc") }}'
      columns:
        - name: contract_address
          description: "Avalanche C address of the ERC721 token contract"
        - *evt_tx_hash
        - *evt_index
        - *evt_block_time
        - *evt_block_number
        - *approved
        - *owner
        - name: tokenId
          description: "Unique identifier of the ERC721 token (NFT) for which approval is granted or revoked"
    - name: evt_ApprovalForAll
      meta:
        docs_slug: /evm/avalanchec/decoded/evt_ApprovalForAll
        short_description: The `avalanche_c.evt_ApprovalForAll` table contains approval events for all tokens of an ERC721 contract on the Avalanche C blockchain.
      loaded_at_field: evt_block_time
      description: '{{ doc("erc721_avalanche_c_evt_ApprovalForAll_doc") }}'
      columns:
        - name: contract_address
          description: "Address of the ERC721 token contract"
        - *evt_tx_hash
        - *evt_index
        - *evt_block_time
        - *evt_block_number
        - *approved
        - *owner
        - name: operator
          description: "Avalanche C address being granted or revoked permission to operate all tokens"